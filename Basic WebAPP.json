{"files":[{"id":"cd82ed59-e6bd-41b4-8a9d-fbed1f4b9777","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Colombo\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE\"\n  }\n}"},{"id":"cdc29905-b4f0-4c71-8896-8acd42886194","name":"Code","type":"server_js","source":"function doGet(e){\n\nLogger.log(e.parameter);\n  return HtmlService.createHtmlOutputFromFile(\"page\");\n\n}\n\n\nfunction userClicked(userInfo){\n  var Url \u003d \"https://docs.google.com/spreadsheets/d/1S12As9yzcAWg219W3LgejdpsCSgFae4-5gHJd8NPrkY/edit#gid\u003d0\";\n  var ss \u003d SpreadsheetApp.openByUrl(Url);\n  var ws \u003d ss.getSheetByName(\"Data\");\n\nws.appendRow([userInfo.firstname,userInfo.lastname,userInfo.app,new Date()]);\n\n//Logger.log(name + \" Clicked the Button\");\n\n}"},{"id":"7044c73d-8f37-4027-ba50-0c268e01f01a","name":"page","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n\u003cbase target\u003d\"_top\"\u003e\n\u003cstyle\u003e\n .form-row{\nmargin-bottom:15px;\n }\n\u003c/style\u003e\n\n  \u003c/head\u003e\n  \n  \u003cbody\u003e \n    \n\n\u003ch1\u003eHello\u003c/h1\u003e\n\u003cdiv class\u003d\"form-row\"\u003e\n\u003clabel\u003eFirst Name:\u003c/label\u003e\u003cinput type\u003d\"text\" id\u003d\"fn\"\u003e\n\u003c/div\u003e\n\u003cdiv class\u003d\"form-row\"\u003e\n  \u003clabel\u003eLast Name:\u003c/label\u003e\u003cinput type\u003d\"text\" id\u003d\"ln\"\u003e\n\u003c/div\u003e\n\u003cdiv class\u003d\"form-row\"\u003e\n\u003clabel\u003eApplication:\u003c/label\u003e\n  \u003cselect id\u003d\"app\"\u003e\n    \u003coption\u003eGoogle Sheets\u003c/option\u003e\n    \u003coption\u003eExcel\u003c/option\u003e\n    \u003coption\u003eNumbers\u003c/option\u003e\n  \u003c/select\u003e\u003e\n\u003c/div\u003e\n\u003cdiv class\u003d\"form-row\"\u003e\n\u003cbutton id\u003d\"btn\"\u003eRun It!\u003c/button\u003e\n\u003c/div\u003e\n\u003cscript\u003e\n\n  document.getElementById(\"btn\").addEventListener(\"click\",doStuff);\n\n  function doStuff(){ \n\n    var userInfo \u003d{};\n\nuserInfo.firstname \u003d document.getElementById(\"fn\").value;\nuserInfo.lastname \u003d document.getElementById(\"ln\").value;\nuserInfo.app \u003d document.getElementById(\"app\").value;\n\n\n\n    google.script.run.userClicked(userInfo);\n\n\ndocument.getElementById(\"fn\").value \u003d \"\";\ndocument.getElementById(\"ln\").value \u003d \"\";\ndocument.getElementById(\"app\").value \u003d \"\";\n\n  }\n\n\u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n\n\n"}]}